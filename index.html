<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ãƒ„ãƒ¼ãƒ«</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px;
  background-color: #ffffff;
}

.container {
  width: 100%;
  max-width: 1000px;
  display: flex;
  gap: 30px;
  align-items: flex-start;
}

/* ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³è¡¨ç¤ºã‚¨ãƒªã‚¢ï¼ˆå¤–æ ï¼‰ */
.countdown-wrapper {
  flex: 1;
  border-radius: 20px;
  overflow: hidden;
  position: relative;
  aspect-ratio: 1 / 1;
  min-width: 300px;
}

/* èƒŒæ™¯ç”»åƒãƒ¬ã‚¤ãƒ¤ãƒ¼ */
.countdown-bg {
  position: absolute;
  top: -20px;
  left: -20px;
  right: -20px;
  bottom: -20px;
  background-size: calc(100% + 40px) auto;
  background-position: center center;
  background-repeat: no-repeat;
  z-index: 1;
}

/* åŠé€æ˜ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ + ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
.countdown-display {
  position: relative;
  z-index: 2;
  padding: 40px 20px;
  background: rgba(0, 0, 0, 0.4);
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  transition: background-color 0.3s ease;
}

.event-name {
  font-size: 1.5rem;
  margin-bottom: 10px;
  color: #ffffff;
  transition: color 0.3s ease;
}

.countdown-text {
  font-size: 4rem;
  font-weight: bold;
  color: #ffffff;
  transition: color 0.3s ease;
}

.countdown-text .days {
  font-size: 8rem;
  display: inline-block;
  margin: 0 5px;
}

/* è¨­å®šãƒ‘ãƒãƒ« */
.settings-panel {
  flex: 1;
  background: rgba(255, 255, 255, 0.95);
  border-radius: 16px;
  padding: 25px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
  min-width: 300px;
}

.settings-title {
  font-size: 1.2rem;
  font-weight: bold;
  margin-bottom: 20px;
  color: #333;
  border-bottom: 2px solid #eee;
  padding-bottom: 10px;
}

.setting-group {
  margin-bottom: 18px;
  text-align: left;
}

.setting-group label {
  display: block;
  font-size: 0.9rem;
  font-weight: 600;
  color: #555;
  margin-bottom: 6px;
}

.setting-group input[type="text"],
.setting-group input[type="date"],
.setting-group input[type="url"] {
  width: 100%;
  padding: 12px 15px;
  border: 2px solid #e0e0e0;
  border-radius: 10px;
  font-size: 1rem;
  transition: border-color 0.3s ease;
}

.setting-group input:focus {
  outline: none;
  border-color: #667eea;
}

.color-inputs {
  display: flex;
  gap: 15px;
}

.color-input-wrapper {
  flex: 1;
}

.color-input-wrapper label {
  font-size: 0.85rem;
}

.color-picker-container {
  display: flex;
  align-items: center;
  gap: 10px;
}

input[type="color"] {
  width: 50px;
  height: 40px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  padding: 0;
}

.color-code {
  flex: 1;
  padding: 10px;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 0.9rem;
  font-family: monospace;
}

/* æ³¨æ„æ›¸ã */
.note {
  font-size: 0.75rem;
  color: #888;
  margin-top: 5px;
}

/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
@media (max-width: 768px) {
  .container {
    flex-direction: column;
    max-width: 500px;
  }

  .countdown-wrapper {
    width: 100%;
    min-width: auto;
  }

  .settings-panel {
    width: 100%;
    min-width: auto;
  }

  .countdown-text {
    font-size: 2rem;
  }

  .countdown-text .days {
    font-size: 3.5rem;
  }

  .event-name {
    font-size: 1.2rem;
  }

  .color-inputs {
    flex-direction: column;
  }
}
</style>
</head>
<body>
<div class="container">
<!-- ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³è¡¨ç¤ºï¼ˆå·¦å´ï¼‰ -->
<div class="countdown-wrapper">
<div class="countdown-bg" id="countdownBg"></div>
<div class="countdown-display" id="countdownDisplay">
<div class="event-name" id="displayEventName">ã‚¤ãƒ™ãƒ³ãƒˆå</div>
<div class="countdown-text">
ã‚ã¨<span class="days" id="daysCount">--</span>æ—¥
</div>
</div>
</div>

<!-- è¨­å®šãƒ‘ãƒãƒ«ï¼ˆå³å´ï¼‰ -->
<div class="settings-panel">
<div class="settings-title">âš™ï¸ è¨­å®š</div>

<div class="setting-group">
<label for="eventName">ğŸ“Œ ã‚¤ãƒ™ãƒ³ãƒˆå</label>
<input type="text" id="eventName" placeholder="ä¾‹ï¼šæ¨ã—ã®ãƒ©ã‚¤ãƒ–" oninput="updateEventName()">
</div>

<div class="setting-group">
<label for="targetDate">ğŸ“… ç›®æ¨™æ—¥</label>
<input type="date" id="targetDate" onchange="updateCountdown()">
</div>

<div class="setting-group">
<label>ğŸ¨ ã‚«ãƒ©ãƒ¼è¨­å®š</label>
<div class="color-inputs">
<div class="color-input-wrapper">
<label>ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è‰²</label>
<div class="color-picker-container">
<input type="color" id="bgColor" value="#000000" onchange="updateOverlayColor()">
<input type="text" class="color-code" id="bgColorCode" value="#000000" onchange="updateOverlayColorFromCode()">
</div>
</div>
<div class="color-input-wrapper">
<label>æ–‡å­—è‰²</label>
<div class="color-picker-container">
<input type="color" id="textColor" value="#ffffff" onchange="updateTextColor()">
<input type="text" class="color-code" id="textColorCode" value="#ffffff" onchange="updateTextColorFromCode()">
</div>
</div>
</div>
</div>

<div class="setting-group">
<label for="bgImage">ğŸ–¼ï¸ èƒŒæ™¯ç”»åƒURL</label>
<input type="url" id="bgImage" placeholder="https://example.com/image.jpg" oninput="updateBackgroundImage()">
<p class="note">â€» ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³è¡¨ç¤ºã‚¨ãƒªã‚¢ã®èƒŒæ™¯ã«ç”»åƒãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>
</div>

<div class="setting-group">
<label>ğŸ”— åŸ‹ã‚è¾¼ã¿URLç”Ÿæˆ</label>
<button type="button" onclick="generateEmbedUrl()" style="
width: 100%;
padding: 12px;
background: #667eea;
color: white;
border: none;
border-radius: 10px;
font-size: 1rem;
font-weight: bold;
cursor: pointer;
">URLã‚’ç”Ÿæˆ</button>
<textarea id="embedUrl" readonly style="
width: 100%;
margin-top: 10px;
padding: 12px;
border: 2px solid #e0e0e0;
border-radius: 10px;
font-size: 0.85rem;
min-height: 80px;
resize: vertical;
display: none;
"></textarea>
<p class="note">â€» ç”Ÿæˆã•ã‚ŒãŸURLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦åŸ‹ã‚è¾¼ã¿ã«ä½¿ç”¨ã—ã¦ãã ã•ã„</p>
</div>
</div>
</div>

<script>
// ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³æ›´æ–°
function updateCountdown() {
const targetDate = document.getElementById('targetDate').value;
const daysElement = document.getElementById('daysCount');

if (!targetDate) {
daysElement.textContent = '--';
return;
}

const target = new Date(targetDate);
target.setHours(0, 0, 0, 0);

const today = new Date();
today.setHours(0, 0, 0, 0);

const diffTime = target - today;
const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

daysElement.textContent = diffDays > 0 ? diffDays : 0;
}

// ã‚¤ãƒ™ãƒ³ãƒˆåæ›´æ–°
function updateEventName() {
const eventName = document.getElementById('eventName').value;
const displayElement = document.getElementById('displayEventName');
displayElement.textContent = eventName ? eventName + 'ã¾ã§' : 'ã‚¤ãƒ™ãƒ³ãƒˆå';
}

// HEXã‚«ãƒ©ãƒ¼ã‚’RGBAã«å¤‰æ›ï¼ˆé€æ˜åº¦0.4å›ºå®šï¼‰
function hexToRgba(hex, alpha = 0.4) {
const r = parseInt(hex.slice(1, 3), 16);
const g = parseInt(hex.slice(3, 5), 16);
const b = parseInt(hex.slice(5, 7), 16);
return `rgba(${r}, ${g}, ${b}, ${alpha})`;
}

// ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è‰²æ›´æ–°ï¼ˆã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼ã‹ã‚‰ï¼‰
function updateOverlayColor() {
const color = document.getElementById('bgColor').value;
document.getElementById('bgColorCode').value = color;
applyOverlayColor(color);
}

// ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è‰²æ›´æ–°ï¼ˆãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã‹ã‚‰ï¼‰
function updateOverlayColorFromCode() {
const color = document.getElementById('bgColorCode').value;
if (/^#[0-9A-Fa-f]{6}$/.test(color)) {
document.getElementById('bgColor').value = color;
applyOverlayColor(color);
}
}

// ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è‰²ã‚’é©ç”¨
function applyOverlayColor(hexColor) {
const displayElement = document.getElementById('countdownDisplay');
displayElement.style.background = hexToRgba(hexColor, 0.4);
}

// æ–‡å­—è‰²æ›´æ–°ï¼ˆã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼ã‹ã‚‰ï¼‰
function updateTextColor() {
const color = document.getElementById('textColor').value;
document.getElementById('textColorCode').value = color;
applyTextColor(color);
}

// æ–‡å­—è‰²æ›´æ–°ï¼ˆãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã‹ã‚‰ï¼‰
function updateTextColorFromCode() {
const color = document.getElementById('textColorCode').value;
if (/^#[0-9A-Fa-f]{6}$/.test(color)) {
document.getElementById('textColor').value = color;
applyTextColor(color);
}
}

// æ–‡å­—è‰²ã‚’é©ç”¨
function applyTextColor(color) {
document.querySelector('.event-name').style.color = color;
document.querySelector('.countdown-text').style.color = color;
}

// èƒŒæ™¯ç”»åƒæ›´æ–°ï¼ˆã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³è¡¨ç¤ºã‚¨ãƒªã‚¢å†…ã«ï¼‰
function updateBackgroundImage() {
const imageUrl = document.getElementById('bgImage').value;
const bgElement = document.getElementById('countdownBg');
if (imageUrl) {
bgElement.style.backgroundImage = `url('${imageUrl}')`;
} else {
bgElement.style.backgroundImage = 'none';
}
}

// URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—
function getUrlParams() {
const params = new URLSearchParams(window.location.search);
return {
event: params.get('event'),
date: params.get('date'),
bg: params.get('bg'),
text: params.get('text'),
image: params.get('image')
};
}

// åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ¼ãƒ‰ã®åˆæœŸåŒ–
function initEmbedMode() {
const params = getUrlParams();

if (params.event || params.date) {
document.querySelector('.settings-panel').style.display = 'none';
document.body.style.padding = '0';
document.body.style.minHeight = 'auto';
document.querySelector('.countdown-wrapper').style.margin = '0';
document.querySelector('.container').style.maxWidth = '100%';

if (params.event) {
document.getElementById('displayEventName').textContent = params.event + 'ã¾ã§';
}

if (params.date) {
document.getElementById('targetDate').value = params.date;
updateCountdown();
}

if (params.bg) {
applyOverlayColor('#' + params.bg);
}

if (params.text) {
applyTextColor('#' + params.text);
}

if (params.image) {
document.getElementById('countdownBg').style.backgroundImage = `url('${params.image}')`;
}
}
}

// åŸ‹ã‚è¾¼ã¿URLç”Ÿæˆ
function generateEmbedUrl() {
const baseUrl = window.location.href.split('?')[0];
const params = [];

const eventName = document.getElementById('eventName').value;
const targetDate = document.getElementById('targetDate').value;
const bgColor = document.getElementById('bgColorCode').value.replace('#', '');
const textColor = document.getElementById('textColorCode').value.replace('#', '');
const bgImage = document.getElementById('bgImage').value;

if (eventName) params.push('event=' + encodeURIComponent(eventName));
if (targetDate) params.push('date=' + targetDate);
if (bgColor) params.push('bg=' + bgColor);
if (textColor) params.push('text=' + textColor);
if (bgImage) params.push('image=' + encodeURIComponent(bgImage));

const embedUrl = baseUrl + '?' + params.join('&');

const textarea = document.getElementById('embedUrl');
textarea.value = embedUrl;
textarea.style.display = 'block';

navigator.clipboard.writeText(embedUrl).then(() => {
alert('URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
}).catch(() => {});
}

// æ¯æ—¥0æ™‚ã«ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚’æ›´æ–°
function scheduleMidnightUpdate() {
const now = new Date();
const midnight = new Date(now);
midnight.setDate(midnight.getDate() + 1);
midnight.setHours(0, 0, 0, 0);

const msUntilMidnight = midnight - now;

setTimeout(() => {
updateCountdown();
scheduleMidnightUpdate();
}, msUntilMidnight);
}

// åˆæœŸåŒ–
scheduleMidnightUpdate();
initEmbedMode();
</script>
</body>
</html>
